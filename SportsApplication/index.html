<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dakar Web Site</title>
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"> -->
    <link rel="stylesheet" href="css/styles.css">
    <!-- jQuery -->
    <!-- <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script> -->
</head>
<body>
    <!-- Enter scores -->
    <h3>Enter Results Here</h3>
    <form id="raceForm">
        <input id="name" type="text" placeholder="Player Name">
        <input id="time" type="text" placeholder="Time: HH:MM:SS" >
        <input id="country" type="text" placeholder="Nationality">
        <label>Vehicle Type</label>
            <select id="vehicle" required>
                <option value="Car">Car</option>
                <option value="Truck">Truck</option>
                <option value="Bike">Bike</option>
            </select>
        <button type="submit">Add Score</button>
    </form>

    <!-- Display the list of saved game scores -->
    <ul id="raceList"></ul>

    <table id="raceTable">
        <thead>
            <th>Name</th>
            <th>Time</th>
            <th>Nationality</th>
            <th>Vehicle</th>
        </thead>
        <tbody id="raceRow"></tbody>
    </table>

    <script>
    // const form = document.getElementById('raceForm');
    // const list = document.getElementById('raceList');
    // const table = document.getElementById('raceTable');
    // const tbody = document.getElementById('raceRow');

    // // Check if local storage has existing scores
    // let scoreData = JSON.parse(localStorage.getItem('scoreData')) || [];

    // // Function to update the table and save to local storage
    // function updateTable() {
    //     tbody.innerHTML = ''; // Clear existing rows

    //     scoreData.forEach((time) => {
    //         const row = document.createElement('tr');
    //         row.innerHTML = `<td>${time.name}</td><td>${time.time}</td><td>${time.country}</td><td>${time.vehicle}</td>`;
    //         tbody.appendChild(row);
    //     });

    //     localStorage.setItem('scoreData', JSON.stringify(scoreData));
    // }

    // // Function to add game scores from the form
    // form.addEventListener('submit', (e) => {
    //     e.preventDefault();

    //     const nameInput = document.getElementById('name');
    //     const timeInput = document.getElementById('time');
    //     const countryInput = document.getElementById('country');
    //     const vehicleInput = document.getElementById('vehicle');

    //     const name = nameInput.value;
    //     const time = timeInput.value;
    //     const country = countryInput.value;
    //     const vehicle = vehicleInput.value;

    //     const result = { name, time, country, vehicle };
    //     scoreData.push(result);
    //     nameInput.value = '';
    //     timeInput.value = '';
    //     countryInput.value = '';
    //     vehicleInput.value = '';
    //     updateList();
    //     updateTable();
    // });

    // // Function to update the list
    // function updateList() {
    //     list.innerHTML = '';
    //     scoreData.forEach((time, index) => {
    //         const listItem = document.createElement('li');
    //         listItem.innerHTML = `<span>${time.name}: ${time.time} - ${time.country}, ${time.vehicle} -</span> <a href="#" onclick="removeScore(${index})">Remove</a>`;
    //         list.appendChild(listItem);
    //     });
    // }

    // // Function to remove a score from the list
    // function removeScore(index) {
    //     scoreData.splice(index, 1);
    //     updateList();
    //     updateTable();
    // }

    const form = document.getElementById('raceForm');
const list = document.getElementById('raceList');
const table = document.getElementById('raceTable');
const tbody = document.getElementById('raceRow');

// Check if local storage has existing scores
let scoreData = JSON.parse(localStorage.getItem('scoreData')) || [];

// Function to add game scores from the form
form.addEventListener('submit', (e) => {
    e.preventDefault();

    const nameInput = document.getElementById('name');
    const timeInput = document.getElementById('time');
    const countryInput = document.getElementById('country');
    const vehicleInput = document.getElementById('vehicle');

    const name = nameInput.value;
    const time = timeInput.value;
    const country = countryInput.value;
    const vehicle = vehicleInput.value;

    const result = { name, time, country, vehicle };
    scoreData.push(result);
    nameInput.value = '';
    timeInput.value = '';
    countryInput.value = '';
    vehicleInput.value = '';
    updateList();
    updateTable();
});

// Function to update the table and save to local storage
function updateTable() {
    tbody.innerHTML = ''; // Clear existing rows

    scoreData.forEach((time) => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${time.name}</td><td>${time.time}</td><td>${time.country}</td><td>${time.vehicle}</td>`;
        tbody.appendChild(row);
    });

    localStorage.setItem('scoreData', JSON.stringify(scoreData));

    // Initialize DataTables on the table
    // if (!table.hasAttribute('data-initialized')) {
    //     // Check if DataTables is not already initialized on the table
    //     table.setAttribute('data-initialized', 'true'); // Set a flag to prevent reinitialization
    //     const raceTable = new DataTable(table);
    // }
}

function addListeners() {
    const headers = document.getElementsByTagName('th');

    Array.from(headers).forEach((header, index) => {
        let isAscending = true;

        header.addEventListener('click', function () {
            sortColumn(index, isAscending);
            isAscending = !isAscending; // Toggle the sorting order
        });
    });
}

function sortColumn(columnIndex, isAscending) {
    // Get all rows in the tbody
    const rows = Array.from(document.getElementById('raceRow').getElementsByTagName('tr'));

    // Sort the rows based on the content of the selected column
    rows.sort((a, b) => {
        const aValue = a.getElementsByTagName('td')[columnIndex].textContent;
        const bValue = b.getElementsByTagName('td')[columnIndex].textContent;

        // Use the localeCompare function to handle string comparison
        const comparison = aValue.localeCompare(bValue, undefined, { numeric: true, sensitivity: 'base' });

        // Toggle the order based on the 'isAscending' flag
        return isAscending ? comparison : -comparison;
    });

    // Update the tbody with the sorted rows
    const tbody = document.getElementById('raceRow');
    tbody.innerHTML = '';
    rows.forEach(row => {
        tbody.appendChild(row);
    });
}



// Function to update the list
function updateList() {
    list.innerHTML = '';
    scoreData.forEach((time, index) => {
        const listItem = document.createElement('li');
        listItem.innerHTML = `<span>${time.name}: ${time.time} - ${time.country}, ${time.vehicle} -</span> <a href="#" onclick="removeScore(${index})">Remove</a>`;
        list.appendChild(listItem);
    });
}

// Function to remove a score from the list
function removeScore(index) {
    scoreData.splice(index, 1);
    updateList();
    updateTable();
}

// Initial list population
updateList();
updateTable();
addListeners();

    </script>


    <!-- Table -->
    <!-- <table>
        <tr>
            <th>Name</th>
            <th>Time</th>
            <th>Nationality</th>
            <th>Vehicle</th>
        </tr>
        <tr>
            <th>Tom</th>
            <th>3:27:41</th>
            <th>GBR</th>
            <th>Truck</th>
        </tr>
        <tr>
            <th>Bill</th>
            <th>3:54:23</th>
            <th>USA</th>
            <th>Car</th>
        </tr>
        <tr>
            <th>Will</th>
            <th>3:59:01</th>
            <th>CAN</th>
            <th>Truck</th>
        </tr>
        <tr>
            <th>Andy</th>
            <th>4:21:09</th>
            <th>AUS</th>
            <th>Bike</th>
        </tr>
        <tr>
            <th>Chad</th>
            <th>4:43:51</th>
            <th>USA</th>
            <th>Car</th>
        </tr>
        <tr>
            <th>Derek</th>
            <th>4:56:27</th>
            <th>CAN</th>
            <th>Bike</th>
        </tr>
        <tr>
            <th>Egg</th>
            <th>5:08:19</th>
            <th>CAN</th>
            <th>Bike</th>
        </tr>
        <tr>
            <th>Fred</th>
            <th>5:34:09</th>
            <th>CHN</th>
            <th>Truck</th>
        </tr>
        <tr>
            <th>Greg</th>
            <th>5:46:14</th>
            <th>CAN</th>
            <th>Car</th>
        </tr>
        <tr>
            <th>Harold</th>
            <th>5:55:12</th>
            <th>USA</th>
            <th>Truck</th>
        </tr>
    </table> -->
    </body>
</html>